(()=>{var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var s in a)e.o(a,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:a[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};(()=>{"use strict";const t=flarum.core.compat["common/app"];e.n(t)().initializers.add("huseyinfiliz/bump",function(){console.log("[huseyinfiliz/bump] Hello, forum and admin!")});const a=flarum.core.compat["admin/app"];var s=e.n(a);function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}function i(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,r(e,t)}const n=flarum.core.compat["admin/components/ExtensionPage"];var o=e.n(n);const l=flarum.core.compat["common/Component"];var u=e.n(l);const d=flarum.core.compat["common/helpers/humanTime"];var p=e.n(d),c=function(e){function t(){return e.apply(this,arguments)||this}i(t,e);var a=t.prototype;return a.view=function(){var e=this.attrs.stats||{totalBumps:0,todayBumps:0,weekBumps:0,absorberActive:!1,lastBumpDate:null};return m("div",{className:"BumpStats"},this.card({icon:"fas fa-level-up-alt",value:e.totalBumps,label:s().translator.trans("huseyinfiliz-bump.admin.stats.total_bumps"),type:"total"}),this.card({icon:"fas fa-calendar-day",value:e.todayBumps,label:s().translator.trans("huseyinfiliz-bump.admin.stats.today_bumps"),type:"today"}),this.card({icon:"fas fa-calendar-week",value:e.weekBumps,label:s().translator.trans("huseyinfiliz-bump.admin.stats.week_bumps"),type:"week"}),this.card({icon:e.lastBumpDate?"far fa-clock":"fas fa-hourglass-start",value:e.lastBumpDate?p()(new Date(e.lastBumpDate)):s().translator.trans("huseyinfiliz-bump.admin.stats.no_bumps_yet"),label:s().translator.trans("huseyinfiliz-bump.admin.stats.last_bump"),type:"last",noNumber:!0}))},a.card=function(e){return m("div",{className:"StatsCard StatsCard--"+e.type},m("div",{className:"StatsCard-icon"},m("i",{className:e.icon})),m("div",{className:"StatsCard-content"},!e.noNumber&&m("div",{className:"StatsCard-value"},e.value),e.noNumber&&m("div",{className:"StatsCard-status"},e.value),m("div",{className:"StatsCard-label"},e.label)))},t}(u());const h=flarum.core.compat["common/components/Button"];var b=e.n(h);const g=flarum.core.compat["common/components/Modal"];var f=e.n(g),v=function(e){function t(){for(var t,a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return(t=e.call.apply(e,[this].concat(s))||this).selectedGroupIds=new Set,t}i(t,e);var a=t.prototype;return a.oninit=function(t){e.prototype.oninit.call(this,t),this.selectedGroupIds=new Set(this.attrs.selectedGroupIds||[])},a.className=function(){return"SelectGroupsModal Modal--small"},a.title=function(){return s().translator.trans("huseyinfiliz-bump.admin.select_groups_modal.title")},a.content=function(){var e=this,t=this.getAvailableGroups();return m("div",{className:"Modal-body"},m("div",{className:"Form"},m("div",{className:"SelectGroups-list"},0===t.length?m("p",{className:"SelectGroups-empty"},s().translator.trans("huseyinfiliz-bump.admin.select_groups_modal.no_groups")):t.map(function(t){return e.groupItem(t)})),m("div",{className:"Form-group"},m(b(),{className:"Button Button--primary",type:"submit",onclick:this.onsubmit.bind(this)},s().translator.trans("huseyinfiliz-bump.admin.select_groups_modal.save")),m(b(),{className:"Button",onclick:function(){return e.hide()}},s().translator.trans("huseyinfiliz-bump.admin.select_groups_modal.cancel")))))},a.groupItem=function(e){var t=this,a=String(e.id()),r=this.selectedGroupIds.has(a),i=e.icon(),n=e.color();return m("label",{className:"SelectGroups-item"+(r?" is-selected":""),key:a},m("input",{type:"checkbox",checked:r,onchange:function(e){e.target.checked?t.selectedGroupIds.add(a):t.selectedGroupIds.delete(a),m.redraw()}}),m("span",{className:"SelectGroups-item-label"},i&&m("span",{className:"SelectGroups-item-icon",style:{color:n||void 0}},m("i",{className:"icon "+i})),m("span",{className:"SelectGroups-item-name"},e.namePlural()),e.isHidden()&&m("span",{className:"Badge Badge--size-small",style:{marginLeft:"8px"}},s().translator.trans("core.admin.groups.hidden"))),r&&m("span",{className:"SelectGroups-item-check"},m("i",{className:"fas fa-check"})))},a.onsubmit=function(e){e.preventDefault();var t=Array.from(this.selectedGroupIds);this.attrs.onsubmit(t),this.hide()},a.getAvailableGroups=function(){return s().store.all("groups").filter(function(e){return"2"!==e.id()}).sort(function(e,t){var a=e.namePlural().toLowerCase(),s=t.namePlural().toLowerCase();return a.localeCompare(s)})},t}(f()),y=function(e){function t(){return e.apply(this,arguments)||this}i(t,e);var a=t.prototype;return a.getModeratorGroups=function(){var e=this.attrs.setting("huseyinfiliz-bump.moderator-groups")(),t=[];try{t=JSON.parse(e||"[]")}catch(e){console.error("Failed to parse moderator-groups setting:",e)}return s().store.all("groups").filter(function(e){return t.includes(String(e.id()))})},a.openModeratorGroupsModal=function(){var e=this,t=this.attrs.setting("huseyinfiliz-bump.moderator-groups")(),a=[];try{a=JSON.parse(t||"[]")}catch(e){console.error("Failed to parse moderator-groups setting:",e)}s().modal.show(v,{selectedGroupIds:a,onsubmit:function(t){e.attrs.setting("huseyinfiliz-bump.moderator-groups")(JSON.stringify(t)),m.redraw()}})},a.removeModeratorGroup=function(e){var t=this.attrs.setting("huseyinfiliz-bump.moderator-groups")(),a=[];try{a=JSON.parse(t||"[]")}catch(e){console.error("Failed to parse moderator-groups setting:",e)}var s=a.filter(function(t){return t!==e});this.attrs.setting("huseyinfiliz-bump.moderator-groups")(JSON.stringify(s)),m.redraw()},a.renderGroupBadges=function(e,t){return e.length>0?e.map(function(e){var a=e.icon(),s=e.color();return m("span",{className:"Badge SelectGroups-badge",key:e.id(),style:{backgroundColor:s||void 0},title:e.namePlural()},a&&m("i",{className:"icon "+a}),e.namePlural(),m("button",{className:"SelectGroups-badge-remove",onclick:function(a){a.preventDefault(),t(String(e.id()))},type:"button"},"Ã—"))}):m("p",{className:"SelectGroups-empty"},s().translator.trans("huseyinfiliz-bump.admin.select_groups_modal.no_groups_selected"))},a.view=function(){var e=this.attrs,t=e.buildSettingComponent,a=e.submitButton;return m("div",{className:"BumpTab"},m("div",{className:"SettingsSection"},m("h3",null,m("i",{className:"fas fa-hand-pointer"}),s().translator.trans("huseyinfiliz-bump.admin.tabs.bump")),m("div",{className:"SettingsSection-content"},m("div",{className:"Form-group"},t({type:"boolean",setting:"huseyinfiliz-bump.enable-manual-bump",label:s().translator.trans("huseyinfiliz-bump.admin.enable_manual_label"),help:s().translator.trans("huseyinfiliz-bump.admin.enable_manual_help")})),m("div",{className:"Form-group"},m("label",null,s().translator.trans("huseyinfiliz-bump.admin.manual_bump_tags_label")),t({type:"flarum-tags.select-tags",setting:"huseyinfiliz-bump.manual-bump-tags",options:{requireParentTag:!1,limits:{max:{secondary:0}}}}),m("p",{className:"helpText"},s().translator.trans("huseyinfiliz-bump.admin.manual_bump_tags_help"))),m("div",{className:"Form-group"},t({type:"number",setting:"huseyinfiliz-bump.manual-cooldown-hours",label:s().translator.trans("huseyinfiliz-bump.admin.manual_cooldown_label"),help:s().translator.trans("huseyinfiliz-bump.admin.manual_cooldown_help"),placeholder:"0",min:0})))),m("div",{className:"SettingsSection"},m("h3",null,m("i",{className:"fas fa-chart-line"}),s().translator.trans("huseyinfiliz-bump.admin.settings.section_quota")),m("div",{className:"SettingsSection-content"},m("div",{className:"Form-group"},t({type:"number",setting:"huseyinfiliz-bump.owner-daily-quota",label:s().translator.trans("huseyinfiliz-bump.admin.owner_daily_quota_label"),help:s().translator.trans("huseyinfiliz-bump.admin.owner_daily_quota_help"),placeholder:"0",min:0})),m("div",{className:"Form-group"},t({type:"number",setting:"huseyinfiliz-bump.owner-weekly-quota",label:s().translator.trans("huseyinfiliz-bump.admin.owner_weekly_quota_label"),help:s().translator.trans("huseyinfiliz-bump.admin.owner_weekly_quota_help"),placeholder:"0",min:0})))),m("div",{className:"SettingsSection"},m("h3",null,m("i",{className:"fas fa-user-shield"}),s().translator.trans("huseyinfiliz-bump.admin.settings.section_bypass")),m("div",{className:"SettingsSection-content"},m("div",{className:"Form-group"},m("label",null,s().translator.trans("huseyinfiliz-bump.admin.moderator_groups_label")),m("div",{className:"SelectGroups-container"},m(b(),{className:"Button",onclick:this.openModeratorGroupsModal.bind(this)},m("i",{className:"fas fa-users"}),s().translator.trans("huseyinfiliz-bump.admin.select_groups_modal.select_button"))),m("div",{className:"SelectGroups-selected"},this.renderGroupBadges(this.getModeratorGroups(),this.removeModeratorGroup.bind(this))),m("p",{className:"helpText"},s().translator.trans("huseyinfiliz-bump.admin.moderator_groups_help"))))),m("div",{className:"Form-group"},a()))},t}(u()),_=function(e){function t(){return e.apply(this,arguments)||this}i(t,e);var a=t.prototype;return a.getAbsorberBypassGroups=function(){var e=this.attrs.setting("huseyinfiliz-bump.absorber-bypass-groups")(),t=[];try{t=JSON.parse(e||"[]")}catch(e){console.error("Failed to parse absorber-bypass-groups setting:",e)}return s().store.all("groups").filter(function(e){return t.includes(String(e.id()))})},a.openAbsorberBypassGroupsModal=function(){var e=this,t=this.attrs.setting("huseyinfiliz-bump.absorber-bypass-groups")(),a=[];try{a=JSON.parse(t||"[]")}catch(e){console.error("Failed to parse absorber-bypass-groups setting:",e)}s().modal.show(v,{selectedGroupIds:a,onsubmit:function(t){e.attrs.setting("huseyinfiliz-bump.absorber-bypass-groups")(JSON.stringify(t)),m.redraw()}})},a.removeAbsorberBypassGroup=function(e){var t=this.attrs.setting("huseyinfiliz-bump.absorber-bypass-groups")(),a=[];try{a=JSON.parse(t||"[]")}catch(e){console.error("Failed to parse absorber-bypass-groups setting:",e)}var s=a.filter(function(t){return t!==e});this.attrs.setting("huseyinfiliz-bump.absorber-bypass-groups")(JSON.stringify(s)),m.redraw()},a.renderGroupBadges=function(e,t){return e.length>0?e.map(function(e){var a=e.icon(),s=e.color();return m("span",{className:"Badge SelectGroups-badge",key:e.id(),style:{backgroundColor:s||void 0},title:e.namePlural()},a&&m("i",{className:"icon "+a}),e.namePlural(),m("button",{className:"SelectGroups-badge-remove",onclick:function(a){a.preventDefault(),t(String(e.id()))},type:"button"},"Ã—"))}):m("p",{className:"SelectGroups-empty"},s().translator.trans("huseyinfiliz-bump.admin.select_groups_modal.no_groups_selected"))},a.view=function(){var e=this.attrs,t=e.buildSettingComponent,a=e.submitButton;return m("div",{className:"AbsorberTab"},m("div",{className:"SettingsSection"},m("h3",null,m("i",{className:"fas fa-hourglass-half"}),s().translator.trans("huseyinfiliz-bump.admin.tabs.absorber")),m("div",{className:"SettingsSection-content"},m("div",{className:"Form-group"},t({type:"boolean",setting:"huseyinfiliz-bump.enable-absorber",label:s().translator.trans("huseyinfiliz-bump.admin.enable_absorber_label"),help:s().translator.trans("huseyinfiliz-bump.admin.enable_absorber_help")})),m("div",{className:"Form-group"},t({type:"number",setting:"huseyinfiliz-bump.threshold-hours",label:s().translator.trans("huseyinfiliz-bump.admin.threshold_hours_label"),help:s().translator.trans("huseyinfiliz-bump.admin.threshold_hours_help"),placeholder:"0",min:0})),m("div",{className:"Form-group"},m("label",null,s().translator.trans("huseyinfiliz-bump.admin.absorber_tags_label")),t({type:"flarum-tags.select-tags",setting:"huseyinfiliz-bump.absorber-tags",options:{requireParentTag:!1,limits:{max:{secondary:0}}}}),m("p",{className:"helpText"},s().translator.trans("huseyinfiliz-bump.admin.absorber_tags_help"))),m("div",{className:"Form-group"},m("label",null,s().translator.trans("huseyinfiliz-bump.admin.absorber_bypass_groups_label")),m("div",{className:"SelectGroups-container"},m(b(),{className:"Button",onclick:this.openAbsorberBypassGroupsModal.bind(this)},m("i",{className:"fas fa-users"}),s().translator.trans("huseyinfiliz-bump.admin.select_groups_modal.select_button"))),m("div",{className:"SelectGroups-selected"},this.renderGroupBadges(this.getAbsorberBypassGroups(),this.removeAbsorberBypassGroup.bind(this))),m("p",{className:"helpText"},s().translator.trans("huseyinfiliz-bump.admin.absorber_bypass_groups_help"))))),m("div",{className:"Form-group"},a()))},t}(u()),N=function(e){function t(){for(var t,a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return(t=e.call.apply(e,[this].concat(s))||this).selectedGroupId=void 0,t.cooldownMode="global",t.cooldownValue="0",t.dailyMode="global",t.dailyValue="0",t.weeklyMode="global",t.weeklyValue="0",t.thresholdMode="global",t.thresholdValue="0",t}i(t,e);var a=t.prototype;return a.oninit=function(t){if(e.prototype.oninit.call(this,t),this.attrs.groupId)this.selectedGroupId=this.attrs.groupId,this.attrs.manualOverride&&(void 0!==this.attrs.manualOverride.cooldown&&(this.cooldownMode="custom",this.cooldownValue=String(this.attrs.manualOverride.cooldown)),void 0!==this.attrs.manualOverride.daily&&(this.dailyMode="custom",this.dailyValue=String(this.attrs.manualOverride.daily)),void 0!==this.attrs.manualOverride.weekly&&(this.weeklyMode="custom",this.weeklyValue=String(this.attrs.manualOverride.weekly))),this.attrs.absorberOverride&&void 0!==this.attrs.absorberOverride.threshold&&(this.thresholdMode="custom",this.thresholdValue=String(this.attrs.absorberOverride.threshold));else{var a,s=this.getAvailableGroups();this.selectedGroupId=String((null==(a=s[0])?void 0:a.id())||"")}},a.className=function(){return"GroupOverrideModal Modal--large"},a.title=function(){return this.attrs.groupId?s().translator.trans("huseyinfiliz-bump.admin.group_override_modal.edit_title"):s().translator.trans("huseyinfiliz-bump.admin.group_override_modal.add_title")},a.content=function(){var e=this,t=this.attrs.globalSettings;return m("div",{className:"Modal-body"},m("form",{onsubmit:this.onsubmit.bind(this),className:"Form"},m("div",{className:"Form-group"},m("label",null,s().translator.trans("huseyinfiliz-bump.admin.group_override_modal.select_group")),this.attrs.groupId?m("input",{className:"FormControl",type:"text",value:this.getGroupName(this.selectedGroupId),disabled:!0}):m("select",{className:"FormControl",value:this.selectedGroupId,oninput:function(t){e.selectedGroupId=t.target.value}},this.getAvailableGroups().map(function(e){return m("option",{key:e.id(),value:String(e.id())},e.namePlural())}))),m("div",{className:"SettingsSection"},m("h3",null,m("i",{className:"fas fa-hand-pointer"}),s().translator.trans("huseyinfiliz-bump.admin.group_override_modal.manual_section")),m("div",{className:"Form-group"},m("label",null,s().translator.trans("huseyinfiliz-bump.admin.manual_cooldown_label")),m("div",{className:"GroupOverride-fieldset"},m("label",{className:"GroupOverride-radio"},m("input",{type:"radio",name:"cooldown-mode",checked:"global"===this.cooldownMode,onclick:function(){e.cooldownMode="global"}}),m("span",null,s().translator.trans("huseyinfiliz-bump.admin.group_override_modal.use_global",{value:t.cooldown}))),m("label",{className:"GroupOverride-radio"},m("input",{type:"radio",name:"cooldown-mode",checked:"custom"===this.cooldownMode,onclick:function(){e.cooldownMode="custom"}}),m("span",null,s().translator.trans("huseyinfiliz-bump.admin.group_override_modal.custom_value")),m("input",{className:"FormControl GroupOverride-input",type:"number",min:"-1",value:this.cooldownValue,disabled:"global"===this.cooldownMode,oninput:function(t){e.cooldownValue=t.target.value}}))),m("p",{className:"helpText"},s().translator.trans("huseyinfiliz-bump.admin.group_override_modal.minus_one_disabled_zero_unlimited"))),m("div",{className:"Form-group"},m("label",null,s().translator.trans("huseyinfiliz-bump.admin.owner_daily_quota_label")),m("div",{className:"GroupOverride-fieldset"},m("label",{className:"GroupOverride-radio"},m("input",{type:"radio",name:"daily-mode",checked:"global"===this.dailyMode,onclick:function(){e.dailyMode="global"}}),m("span",null,s().translator.trans("huseyinfiliz-bump.admin.group_override_modal.use_global",{value:t.daily}))),m("label",{className:"GroupOverride-radio"},m("input",{type:"radio",name:"daily-mode",checked:"custom"===this.dailyMode,onclick:function(){e.dailyMode="custom"}}),m("span",null,s().translator.trans("huseyinfiliz-bump.admin.group_override_modal.custom_value")),m("input",{className:"FormControl GroupOverride-input",type:"number",min:"-1",value:this.dailyValue,disabled:"global"===this.dailyMode,oninput:function(t){e.dailyValue=t.target.value}}))),m("p",{className:"helpText"},s().translator.trans("huseyinfiliz-bump.admin.group_override_modal.minus_one_disabled_zero_unlimited"))),m("div",{className:"Form-group"},m("label",null,s().translator.trans("huseyinfiliz-bump.admin.owner_weekly_quota_label")),m("div",{className:"GroupOverride-fieldset"},m("label",{className:"GroupOverride-radio"},m("input",{type:"radio",name:"weekly-mode",checked:"global"===this.weeklyMode,onclick:function(){e.weeklyMode="global"}}),m("span",null,s().translator.trans("huseyinfiliz-bump.admin.group_override_modal.use_global",{value:t.weekly}))),m("label",{className:"GroupOverride-radio"},m("input",{type:"radio",name:"weekly-mode",checked:"custom"===this.weeklyMode,onclick:function(){e.weeklyMode="custom"}}),m("span",null,s().translator.trans("huseyinfiliz-bump.admin.group_override_modal.custom_value")),m("input",{className:"FormControl GroupOverride-input",type:"number",min:"-1",value:this.weeklyValue,disabled:"global"===this.weeklyMode,oninput:function(t){e.weeklyValue=t.target.value}}))),m("p",{className:"helpText"},s().translator.trans("huseyinfiliz-bump.admin.group_override_modal.minus_one_disabled_zero_unlimited")))),m("div",{className:"SettingsSection"},m("h3",null,m("i",{className:"fas fa-hourglass-half"}),s().translator.trans("huseyinfiliz-bump.admin.group_override_modal.absorber_section")),m("div",{className:"Form-group"},m("label",null,s().translator.trans("huseyinfiliz-bump.admin.threshold_hours_label")),m("div",{className:"GroupOverride-fieldset"},m("label",{className:"GroupOverride-radio"},m("input",{type:"radio",name:"threshold-mode",checked:"global"===this.thresholdMode,onclick:function(){e.thresholdMode="global"}}),m("span",null,s().translator.trans("huseyinfiliz-bump.admin.group_override_modal.use_global",{value:t.threshold}))),m("label",{className:"GroupOverride-radio"},m("input",{type:"radio",name:"threshold-mode",checked:"custom"===this.thresholdMode,onclick:function(){e.thresholdMode="custom"}}),m("span",null,s().translator.trans("huseyinfiliz-bump.admin.group_override_modal.custom_value")),m("input",{className:"FormControl GroupOverride-input",type:"number",min:"0",value:this.thresholdValue,disabled:"global"===this.thresholdMode,oninput:function(t){e.thresholdValue=t.target.value}}))),m("p",{className:"helpText"},s().translator.trans("huseyinfiliz-bump.admin.group_override_modal.zero_means_bypass")))),m("div",{className:"Form-group"},m(b(),{className:"Button Button--primary",type:"submit",loading:this.loading},s().translator.trans("huseyinfiliz-bump.admin.group_override_modal.save")),m(b(),{className:"Button",onclick:function(){return e.hide()}},s().translator.trans("huseyinfiliz-bump.admin.group_override_modal.cancel")))))},a.onsubmit=function(e){e.preventDefault();var t={};"custom"===this.cooldownMode&&(t.cooldown=parseInt(this.cooldownValue)||0),"custom"===this.dailyMode&&(t.daily=parseInt(this.dailyValue)||0),"custom"===this.weeklyMode&&(t.weekly=parseInt(this.weeklyValue)||0);var a={};"custom"===this.thresholdMode&&(a.threshold=parseInt(this.thresholdValue)||0),this.attrs.onsubmit(this.selectedGroupId,t,a),this.hide()},a.getAvailableGroups=function(){var e=this;return s().store.all("groups").filter(function(t){var a=String(t.id());return"2"!==a&&!e.attrs.existingGroupIds.includes(a)})},a.getGroupName=function(e){var t=s().store.getById("groups",e);return t?t.namePlural():e},t}(f()),z=function(e){function t(){return e.apply(this,arguments)||this}i(t,e);var a=t.prototype;return a.oninit=function(t){e.prototype.oninit.call(this,t),this.autoCleanupInvalidOverrides()},a.autoCleanupInvalidOverrides=function(){var e=this.getManualOverrides(),t=this.getAbsorberOverrides(),a=this.attrs.setting("huseyinfiliz-bump.group-overrides-manual")()||"{}",s=this.attrs.setting("huseyinfiliz-bump.group-overrides-absorber")()||"{}",r=JSON.parse(a),i=JSON.parse(s),n=Object.keys(r).length!==Object.keys(e).length,o=Object.keys(i).length!==Object.keys(t).length;(n||o)&&(this.attrs.setting("huseyinfiliz-bump.group-overrides-manual")(JSON.stringify(e)),this.attrs.setting("huseyinfiliz-bump.group-overrides-absorber")(JSON.stringify(t)),this.attrs.onDirty())},a.view=function(){var e=this,t=this.attrs.submitButton,a=this.getManualOverrides(),r=this.getAbsorberOverrides(),i=this.getConfiguredGroupIds(a,r);return m("div",{className:"GroupOverridesTab"},m("div",{className:"GroupOverrides-intro"},m("p",null,s().translator.trans("huseyinfiliz-bump.admin.group_overrides.description")),m("p",{className:"helpText"},s().translator.trans("huseyinfiliz-bump.admin.group_overrides.help"))),m("div",{className:"GroupOverrides-actions"},m(b(),{className:"Button Button--primary",icon:"fas fa-plus",onclick:function(){return e.showAddModal()}},s().translator.trans("huseyinfiliz-bump.admin.group_overrides.add_override"))),i.length>0?m("div",{className:"GroupOverrides-list"},i.map(function(t){return e.renderGroupCard(t,a,r)})):m("div",{className:"EmptyState"},m("div",{className:"EmptyState-icon"},m("i",{className:"fas fa-users-cog"})),m("p",null,s().translator.trans("huseyinfiliz-bump.admin.group_overrides.no_overrides")),m("p",{className:"helpText"},s().translator.trans("huseyinfiliz-bump.admin.group_overrides.get_started"))),m("div",{className:"Form-group"},t()))},a.renderGroupCard=function(e,t,a){var r=this,i=s().store.getById("groups",e),n=i?i.namePlural():"Group "+e,o=t[e]||{},l=a[e]||{},u=this.getGlobalSettings();return m("div",{className:"GroupOverrideCard",key:e},m("div",{className:"GroupOverrideCard-header"},m("div",{className:"GroupOverrideCard-title"},m("i",{className:"fas fa-users"}),m("strong",null,n)),m("div",{className:"GroupOverrideCard-actions"},m(b(),{className:"Button Button--text",icon:"fas fa-edit",onclick:function(){return r.showEditModal(e)}},s().translator.trans("huseyinfiliz-bump.admin.group_overrides.edit")),m(b(),{className:"Button Button--text Button--danger",icon:"fas fa-trash",onclick:function(){return r.removeOverride(e)}},s().translator.trans("huseyinfiliz-bump.admin.group_overrides.remove")))),m("div",{className:"GroupOverrideCard-content"},m("div",{className:"GroupOverrideCard-section"},m("h4",null,m("i",{className:"fas fa-hand-pointer"}),s().translator.trans("huseyinfiliz-bump.admin.tabs.bump")),m("div",{className:"GroupOverrideCard-settings"},this.renderSetting(String(s().translator.trans("huseyinfiliz-bump.admin.manual_cooldown_label")),o.cooldown,u.cooldown,"hours"),this.renderSetting(String(s().translator.trans("huseyinfiliz-bump.admin.owner_daily_quota_label")),o.daily,u.daily,"bumps"),this.renderSetting(String(s().translator.trans("huseyinfiliz-bump.admin.owner_weekly_quota_label")),o.weekly,u.weekly,"bumps"))),m("div",{className:"GroupOverrideCard-section"},m("h4",null,m("i",{className:"fas fa-hourglass-half"}),s().translator.trans("huseyinfiliz-bump.admin.tabs.absorber")),m("div",{className:"GroupOverrideCard-settings"},this.renderSetting(String(s().translator.trans("huseyinfiliz-bump.admin.threshold_hours_label")),l.threshold,u.threshold,"hours")))))},a.renderSetting=function(e,t,a,r){var i=void 0!==t,n=i?t:a,o=0===n;return m("div",{className:"GroupOverrideSetting"},m("span",{className:"GroupOverrideSetting-label"},e,":"),m("span",{className:"GroupOverrideSetting-value"+(i?" GroupOverrideSetting-value--custom":"")},o?s().translator.trans("huseyinfiliz-bump.admin.group_overrides.unlimited"):n+" "+r,!i&&m("span",{className:"GroupOverrideSetting-badge"},s().translator.trans("huseyinfiliz-bump.admin.group_overrides.using_global"))))},a.getManualOverrides=function(){try{var e=this.attrs.setting("huseyinfiliz-bump.group-overrides-manual")()||"{}",t=JSON.parse(e);return this.cleanupOverrides(t)}catch(e){return console.error("Failed to parse manual overrides:",e),{}}},a.getAbsorberOverrides=function(){try{var e=this.attrs.setting("huseyinfiliz-bump.group-overrides-absorber")()||"{}",t=JSON.parse(e);return this.cleanupOverrides(t)}catch(e){return console.error("Failed to parse absorber overrides:",e),{}}},a.cleanupOverrides=function(e){var t={};return Object.keys(e).forEach(function(a){var s=parseInt(a);isNaN(s)||String(s)!==a||(t[a]=e[a])}),t},a.getConfiguredGroupIds=function(e,t){var a=Object.keys(e),s=Object.keys(t);return Array.from(new Set([].concat(a,s))).filter(function(e){var t=parseInt(e,10);return!isNaN(t)&&String(t)===e}).sort(function(e,t){return parseInt(e,10)-parseInt(t,10)})},a.getGlobalSettings=function(){return{cooldown:parseInt(s().data.settings["huseyinfiliz-bump.manual-cooldown-hours"]||"0"),daily:parseInt(s().data.settings["huseyinfiliz-bump.owner-daily-quota"]||"0"),weekly:parseInt(s().data.settings["huseyinfiliz-bump.owner-weekly-quota"]||"0"),threshold:parseInt(s().data.settings["huseyinfiliz-bump.threshold-hours"]||"0")}},a.showAddModal=function(){var e=this,t=this.getManualOverrides(),a=this.getAbsorberOverrides();s().modal.show(N,{globalSettings:this.getGlobalSettings(),existingGroupIds:this.getConfiguredGroupIds(t,a),onsubmit:function(t,a,s){e.saveOverride(t,a,s)}})},a.showEditModal=function(e){var t=this,a=this.getManualOverrides(),r=this.getAbsorberOverrides();s().modal.show(N,{groupId:e,manualOverride:a[e],absorberOverride:r[e],globalSettings:this.getGlobalSettings(),existingGroupIds:this.getConfiguredGroupIds(a,r),onsubmit:function(e,a,s){t.saveOverride(e,a,s)}})},a.saveOverride=function(e,t,a){var s=this.getManualOverrides(),r=this.getAbsorberOverrides();Object.keys(t).length>0?s[e]=t:delete s[e],Object.keys(a).length>0?r[e]=a:delete r[e],this.attrs.setting("huseyinfiliz-bump.group-overrides-manual")(JSON.stringify(s)),this.attrs.setting("huseyinfiliz-bump.group-overrides-absorber")(JSON.stringify(r)),this.attrs.onDirty(),m.redraw()},a.removeOverride=function(e){if(confirm(String(s().translator.trans("huseyinfiliz-bump.admin.group_overrides.confirm_remove")))){var t=this.getManualOverrides(),a=this.getAbsorberOverrides();delete t[e],delete a[e],this.attrs.setting("huseyinfiliz-bump.group-overrides-manual")(JSON.stringify(t)),this.attrs.setting("huseyinfiliz-bump.group-overrides-absorber")(JSON.stringify(a)),this.attrs.onDirty(),m.redraw()}},t}(u()),S=function(e){function t(){return e.apply(this,arguments)||this}i(t,e);var a=t.prototype;return a.view=function(){var e=this,t=this.attrs,a=t.recentBumps;return t.loading?m("div",{className:"LoadingState"},m("div",{className:"LoadingIndicator"}),m("p",null,s().translator.trans("huseyinfiliz-bump.admin.recent_bumps.loading"))):a&&0!==a.length?m("div",{className:"RecentBumpsList"},m("div",{className:"RecentBumps-header"},m("h3",null,m("i",{className:"fas fa-history"}),s().translator.trans("huseyinfiliz-bump.admin.recent_bumps.title")),m("span",{className:"RecentBumps-count"},s().translator.trans("huseyinfiliz-bump.admin.recent_bumps.showing",{count:a.length}))),m("div",{className:"RecentBumps-list"},a.map(function(t){return e.bumpCard(t)}))):m("div",{className:"EmptyState"},m("div",{className:"EmptyState-icon"},m("i",{className:"fas fa-level-up-alt"})),m("h3",null,s().translator.trans("huseyinfiliz-bump.admin.recent_bumps.title")),m("p",null,s().translator.trans("huseyinfiliz-bump.admin.recent_bumps.no_bumps")))},a.bumpCard=function(e){var t=s().forum.attribute("baseUrl")+"/d/"+e.discussion_id+"-"+e.discussion_slug;return m("div",{key:e.id,className:"BumpCard BumpCard--manual"},m("div",{className:"BumpCard-header"},m("div",{className:"BumpCard-discussion"},m("i",{className:"fas fa-comments"}),m("a",{href:t,target:"_blank",rel:"noopener noreferrer"},m("strong",null,e.discussion_title||s().translator.trans("huseyinfiliz-bump.admin.recent_bumps.untitled")))),m("div",{className:"BumpCard-meta"},m("span",{className:"BumpCard-typeBadge BumpCard-typeBadge--manual"},m("i",{className:"fas fa-hand-pointer"}),m("span",null,s().translator.trans("huseyinfiliz-bump.admin.recent_bumps.type_manual"))),m("span",{className:"BumpCard-dateBadge"},m("i",{className:"far fa-clock"}),m("span",null,p()(new Date(e.created_at)))))),m("div",{className:"BumpCard-footer"},e.username&&m("div",{className:"BumpCard-user"},m("i",{className:"fas fa-user"}),m("span",null,e.username)),!e.username&&m("div",{className:"BumpCard-user"},m("i",{className:"fas fa-robot"}),m("span",null,s().translator.trans("huseyinfiliz-bump.admin.recent_bumps.system"))),m("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"BumpCard-link"},s().translator.trans("huseyinfiliz-bump.admin.recent_bumps.view_discussion"),m("i",{className:"fas fa-external-link-alt"}))))},t}(u()),w=function(e){function t(){for(var t,a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return(t=e.call.apply(e,[this].concat(s))||this).activeTab="bump",t.loading=!1,t.stats=null,t.recentBumps=[],t.groupOverridesDirty=!1,t}i(t,e);var a=t.prototype;return a.oninit=function(t){e.prototype.oninit.call(this,t),this.setting("huseyinfiliz-bump.enable-absorber","false"),this.setting("huseyinfiliz-bump.threshold-hours","0"),this.setting("huseyinfiliz-bump.absorber-tags","[]"),this.setting("huseyinfiliz-bump.absorber-bypass-groups","[]"),this.setting("huseyinfiliz-bump.enable-manual-bump","false"),this.setting("huseyinfiliz-bump.manual-bump-tags","[]"),this.setting("huseyinfiliz-bump.manual-cooldown-hours","0"),this.setting("huseyinfiliz-bump.moderator-groups","[]"),this.setting("huseyinfiliz-bump.owner-daily-quota","0"),this.setting("huseyinfiliz-bump.owner-weekly-quota","0"),this.setting("huseyinfiliz-bump.group-overrides-manual","{}"),this.setting("huseyinfiliz-bump.group-overrides-absorber","{}"),this.loadStats()},a.isChanged=function(){return e.prototype.isChanged.call(this)||(this.groupOverridesDirty?1:0)},a.onsaved=function(){e.prototype.onsaved.call(this),this.groupOverridesDirty=!1,s().request({method:"POST",url:s().forum.attribute("apiUrl")+"/bump/clear-cache"})},a.content=function(){return m("div",{className:"BumpPage"},m(c,{stats:this.stats}),this.tabs(),m("div",{className:"BumpPage-content"},this.activeTabContent()))},a.tabs=function(){var e=this;return m("div",{className:"BumpTabs"},m("button",{className:"TabButton"+("bump"===this.activeTab?" active":""),onclick:function(){e.activeTab="bump"}},m("i",{className:"fas fa-hand-pointer"}),m("span",null,s().translator.trans("huseyinfiliz-bump.admin.tabs.bump"))),m("button",{className:"TabButton"+("absorber"===this.activeTab?" active":""),onclick:function(){e.activeTab="absorber"}},m("i",{className:"fas fa-hourglass-half"}),m("span",null,s().translator.trans("huseyinfiliz-bump.admin.tabs.absorber"))),m("button",{className:"TabButton"+("groups"===this.activeTab?" active":""),onclick:function(){e.activeTab="groups"}},m("i",{className:"fas fa-users-cog"}),m("span",null,s().translator.trans("huseyinfiliz-bump.admin.tabs.group_overrides"))),m("button",{className:"TabButton"+("recent"===this.activeTab?" active":""),onclick:function(){e.activeTab="recent"}},m("i",{className:"fas fa-history"}),m("span",null,s().translator.trans("huseyinfiliz-bump.admin.tabs.recent_bumps")),this.recentBumps.length>0&&m("span",{className:"TabButton-badge"},this.recentBumps.length)))},a.activeTabContent=function(){var e=this;switch(this.activeTab){case"bump":return m(y,{buildSettingComponent:this.buildSettingComponent.bind(this),submitButton:this.submitButton.bind(this),setting:this.setting.bind(this)});case"absorber":return m(_,{buildSettingComponent:this.buildSettingComponent.bind(this),submitButton:this.submitButton.bind(this),setting:this.setting.bind(this)});case"groups":return m(z,{buildSettingComponent:this.buildSettingComponent.bind(this),submitButton:this.submitButton.bind(this),setting:this.setting.bind(this),onDirty:function(){e.groupOverridesDirty=!0,m.redraw()}});case"recent":return m(S,{recentBumps:this.recentBumps,loading:this.loading});default:return null}},a.loadStats=function(){var e=this;this.loading=!0,m.redraw(),s().request({method:"GET",url:s().forum.attribute("apiUrl")+"/bump/stats"}).then(function(t){var a,s=(null==(a=t.data)?void 0:a.attributes)||t;e.stats={totalBumps:s.totalBumps||0,todayBumps:s.todayBumps||0,weekBumps:s.weekBumps||0,absorberActive:s.absorberActive||!1,lastBumpDate:s.lastBumpDate||null},e.recentBumps=s.recentBumps||[],e.loading=!1,m.redraw()}).catch(function(){e.stats={totalBumps:0,todayBumps:0,weekBumps:0,absorberActive:!1,lastBumpDate:null},e.recentBumps=[],e.loading=!1,m.redraw()})},t}(o());s().initializers.add("huseyinfiliz/bump",function(){s().extensionData.for("huseyinfiliz-bump").registerPage(w)})})(),module.exports={}})();
//# sourceMappingURL=admin.js.map